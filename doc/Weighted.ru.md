# Взвешенная сумма

## Аналогия с покупками

Представьте, что у вас есть:
*   3 яблока
*   2 апельсина
*   5 слив

Если вы просто сложите количество, у вас получится `3 + 2 + 5 = 10` фруктов. Это `As is`.

Но что, если вы хотите узнать **общий вес** покупки? Вам нужно знать вес каждого фрукта:
*   Одно яблоко весит 150 г.
*   Один апельсин весит 200 г.
*   Одна слива весит 30 г.

Теперь, чтобы найти общий вес, вы умножаете количество каждого фрукта на его вес, а затем складываете результаты:
`3 * 150 + 2 * 200 + 5 * 30 = 450 + 400 + 150 = 1000 г`

Это и есть **взвешенная сумма**. Каждое слагаемое (количество фруктов) получает свой "вес" или "коэффициент важности" (в данном случае, вес одного фрукта).

### Применение в коде

В вашей программе происходит то же самое, но с химическими компонентами:

1.  **`A(I)` и `B(I)` — это "количество фруктов"**. Это площадь пика, полученная с помощью газо-жидкостной хроматографии (GLC). Площадь пика примерно пропорциональна количеству (в молях) каждого химического компонента в смеси. Но это лишь сигнал прибора, а не масса.

2.  **`WAG(I)` — это "вес одного фрукта"**. Это **молекулярная масса** (или вес) каждого компонента. Разные молекулы (жирные кислоты, обозначенные как 'Pi', 'Pa', 'Ol' и т.д.) имеют разную массу. Например, молекула стеариновой кислоты ('St') тяжелее молекулы пальмитиновой кислоты ('Pi').

#### Зачем это нужно?

Цель программы — перейти от относительных сигналов прибора (`A(I)`) к физически значимым величинам, таким как **массовая доля** каждого компонента.

*   **Без взвешивания:** Если бы мы просто сложили все `A(I)`, мы бы получили общую площадь пиков. Разделив `A(I)` на эту сумму, мы бы узнали, какую *долю от общего сигнала прибора* составляет каждый компонент. Это не очень информативно, потому что прибор может по-разному реагировать на разные вещества.

*   **С взвешиванием (как в коде):** Формула `SAM = SAM + A(I)/10 * WAG(I)` по сути вычисляет **общую массу** всех компонентов в образце (с поправкой на масштабный коэффициент 1/10).
    *   `A(I)` — условное количество молей компонента `I`.
    *   `WAG(I)` — масса одного моля компонента `I`.
    *   `A(I) * WAG(I)` — условная масса компонента `I` в смеси.
    *   `SAM` — условная **общая масса** всей смеси.

Когда программа затем вычисляет `MAL(I) = A(I) / SAM`, она находит не просто долю сигнала, а **массовую долю** — то есть, какой процент от общей массы образца составляет каждый компонент. Это стандартная и общепринятая практика в аналитической химии.

### Ссылки для дополнительного чтения

Эта концепция является фундаментальной для количественного анализа в химии.

1.  **Что такое взвешенная сумма (общая концепция)**:
    *   **Википедия — Взвешенная сумма**: Здесь дано строгое математическое определение. Это поможет понять общую идею, не привязанную к химии.
        [https://ru.wikipedia.org/wiki/Взвешенная_сумма](https://ru.wikipedia.org/wiki/Взвешенная_сумма)

2.  **Применение в хроматографии (конкретный случай)**:
    *   **Количественный анализ в газовой хроматографии**: Статьи и учебные материалы по этой теме объясняют, почему для перехода от площадей пиков к концентрациям или массовым долям необходимо использовать калибровочные коэффициенты или молекулярные массы.
    *   **Статья о количественном анализе**: Этот ресурс (на английском, но можно использовать переводчик) хорошо объясняет методы расчета, включая метод внутреннего стандарта и нормализации, где используются "относительные факторы отклика", тесно связанные с молекулярной массой.
        [https://www.chem.agilent.com/Library/applications/5990-3368EN.pdf](https://www.chem.agilent.com/Library/applications/5990-3368EN.pdf) (см. раздел "Area %")
    *   **Обсуждение на форуме химиков**: Часто в таких обсуждениях можно найти практические объяснения, почему нельзя просто складывать площади пиков. Вот пример такого обсуждения:
        [https://www.researchgate.net/post/How_to_calculate_the_concentration_of_unknown_sample_from_the_peak_area_of_HPLC](https://www.researchgate.net/post/How_to_calculate_the_concentration_of_unknown_sample_from_the_peak_area_of_HPLC)
